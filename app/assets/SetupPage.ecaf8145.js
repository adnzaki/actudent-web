import{aI as y,aJ as b,aK as u,b as S,aC as f,aL as d,_ as D,a as w,ax as x,a8 as V,ag as C,o as Q,k as T,g as r,f as a,p as g,v as P,n as z,m as q,L as B,aD as R,aE as U,Q as _,aM as s,i as m,j as F,s as L,aG as M,O as I,R as N,S as A}from"./index.eff39408.js";import{Q as O,a as E}from"./QLayout.07003c1a.js";import{_ as G}from"./icon-512x512.84c0ad7c.js";const K=y("setup",{state:()=>({showProgressMessage:!0,progressMessage:"Installing %s module...",installSuccess:!1,postData:{organization_name:"",subscription_type:"Free",database_name:"",token:""},error:{},progressColor:"bg-accent",disableButton:!1,timeout:3e3}),actions:{checkInstallation(){const e=b.show({message:"Checking database installation...",group:"check"});u.get("check").then(({data:o})=>{o.status===1?(e({message:"Database has been installed, access to this feature is disabled. Redirecting to login page..."}),setTimeout(()=>{b.hide(),window.location.href=S.loginUrl()},4e3)):setTimeout(()=>{b.hide()},1e3)})},setupOrganization(){u.post("create-organization",this.postData,{transformRequest:[e=>f(e)]}).then(({data:e})=>{const o=d.create({message:e.msg,spinner:!1,color:e.status==="failed"?"negative":"positive",icon:e.status==="failed"?"report_problem":"verified",position:"center",timeout:0});setTimeout(()=>{o(),window.location.href=S.loginUrl()},this.timeout+1e3)})},createTimelog(){this.doInstall("timelog",()=>{d.create({group:!1,spinner:!0,message:"Database successfully installed. Setting up organization details...",color:"positive",position:"center",timeout:this.timeout}),setTimeout(()=>{this.setupOrganization()},this.timeout)})},createSetting(){this.doInstall("setting",()=>this.createTimelog())},createSchool(){this.doInstall("school",()=>this.createSetting())},createTimeline(){this.doInstall("timeline",()=>this.createSchool())},createAgenda(){this.doInstall("agenda",()=>this.createTimeline())},createPresence(){this.doInstall("presence",()=>this.createAgenda())},createSchedule(){this.doInstall("schedule",()=>this.createPresence())},createLesson(){this.doInstall("lessons",()=>this.createSchedule())},createRoom(){this.doInstall("room",()=>this.createLesson())},createStudent(){this.doInstall("student",()=>this.createRoom())},createGrade(){this.doInstall("grade",()=>this.createStudent())},createStaff(){this.doInstall("staff",()=>this.createGrade())},createParent(){this.doInstall("parent",()=>this.createStaff())},createSession(){this.doInstall("session",()=>this.createParent())},createUser(){this.doInstall("user",()=>this.createSession())},doInstall(e,o){const t=d.create({group:"notify",spinner:!0,message:this.progressMessage.replace("%s",e),color:"accent",position:"center",timeout:0});u.post(`create/${e}`,{token:this.postData.token},{transformRequest:[c=>f(c)]}).then(({data:c})=>{c.status==="OK"?setTimeout(()=>{e==="timelog"&&t(),o()},500):setTimeout(()=>{t(),d.create({message:"Installation failed, please provide a valid developer token.",timeout:this.timeout+1e3,icon:"report_problem",color:"negative",position:"center"}),this.disableButton=!1},1e3)})},validateForm(){this.showProgressMessage=!0,this.disableButton=!0;const e=d.create({group:!1,spinner:!0,message:"Validating forms...",color:"accent",position:"center",timeout:0});u.post("validate",this.postData,{transformRequest:[o=>f(o)]}).then(({data:o})=>{e({timeout:this.timeout}),o.status==="success"?(this.createUser(),e({timeout:1}),this.error={}):(e({color:"negative",message:"Unable to install database, please fill the form correctly.",icon:"report_problem",spinner:!1}),this.error=o.msg,this.disableButton=!1)})}}});const $=e=>(N("data-v-2995de9e"),e=e(),A(),e),j={class:"q-pa-md q-mt-md row items-start q-gutter-md"},H=$(()=>g("p",{class:"text-center text-uppercase q-pt-lg q-pb-sm"},[I(" Welcome to Actudent Database Installation page "),g("br"),g("strong",null,"This feature is intended to be used for developer only")],-1)),J={__name:"SetupPage",setup(e){const o=w(),t=K(),c=()=>{},k=["Free","Starter","Standard","Enhanced","Enterprise"],v=x({fontSize:"18px",width:"calc(100% - 5px)",borderRadius:o.screen.lt.sm?"28px":"5px"});V(()=>t.checkInstallation());const i=h=>{const l={light:{bgImage:"bg-img-light",card:"",icon:"primary",label:"",input:"auth-input",inputColor:"input-color",btn:"blue",poweredLogo:"powered-style"},dark:{bgImage:"bg-img-dark",card:"auth-box-dark",icon:"blue-1",label:"blue-1",input:"auth-input-dark",inputColor:"input-color-dark",btn:"cyan-10",poweredLogo:""}};return o.cookies.get("theme")==="dark"?l.dark[h]:l.light[h]};return(h,l)=>{const p=C("ac-error");return Q(),T(E,{view:"hHh lpR fFf",class:"bg-install"},{default:r(()=>[a(O,null,{default:r(()=>[g("div",j,[a(P,{class:z(["auth-box col-md-4 col-sm-8 offset-md-4 offset-sm-2",i("card")])},{default:r(()=>[a(q,null,{default:r(()=>[a(B,{src:G,width:"20%",ratio:1,class:"app-logo"}),H,a(R,{class:"q-gutter-xs",onSubmit:U(c,["prevent"])},{default:r(()=>[a(_,{filled:"",modelValue:s(t).postData.organization_name,"onUpdate:modelValue":l[0]||(l[0]=n=>s(t).postData.organization_name=n),label:"School Name","label-color":i("label"),color:i("icon")},{prepend:r(()=>[a(m,{name:"o_business"})]),_:1},8,["modelValue","label-color","color"]),a(p,{label:s(t).error.organization_name},null,8,["label"]),a(F,{filled:"",modelValue:s(t).postData.subscription_type,"onUpdate:modelValue":l[1]||(l[1]=n=>s(t).postData.subscription_type=n),options:k},{prepend:r(()=>[a(m,{name:"bookmarks"})]),_:1},8,["modelValue"]),a(p,{label:s(t).error.subscription_type},null,8,["label"]),a(_,{filled:"",modelValue:s(t).postData.database_name,"onUpdate:modelValue":l[2]||(l[2]=n=>s(t).postData.database_name=n),label:"Database Name (for Android API)","label-color":i("label"),color:i("icon")},{prepend:r(()=>[a(m,{name:"storage"})]),_:1},8,["modelValue","label-color","color"]),a(p,{label:s(t).error.database_name},null,8,["label"]),a(_,{filled:"",modelValue:s(t).postData.token,"onUpdate:modelValue":l[3]||(l[3]=n=>s(t).postData.token=n),label:"Developer Token","label-color":i("label"),color:i("icon")},{prepend:r(()=>[a(m,{name:"vpn_key"})]),_:1},8,["modelValue","label-color","color"]),a(p,{label:s(t).error.token},null,8,["label"]),a(L,{color:i("btn"),onClick:s(t).validateForm,style:M(v),disable:s(t).disableButton},{default:r(()=>[I("Install")]),_:1},8,["color","onClick","style","disable"])]),_:1})]),_:1})]),_:1},8,["class"])])]),_:1})]),_:1})}}};var Z=D(J,[["__scopeId","data-v-2995de9e"]]);export{Z as default};
