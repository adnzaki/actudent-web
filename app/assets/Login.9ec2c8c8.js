import{Q as _}from"./QImg.71ec6640.js";import{_ as N,aB as T,a as U,b as t,C as d,c as B,x as g,aC as D,aD as P,ax as E,o as x,k as K,g as m,f as l,n as f,p as h,v as z,m as F,t as y,aE as R,aF as H,Q as S,h as C,i as L,aG as A,d as G,J as j,s as J,aH as Q,N as O,aI as k}from"./index.12ad3470.js";import{Q as W,a as X}from"./QLayout.677b5cd9.js";var Y="/app/assets/icon-512x512.31a7681c.png",Z="/app/assets/company-logo.6eb4ff1e.png";const $={name:"LoginPage",beforeRouteEnter(a,o,c){let e="/login";k==="1"?e="/home":(k==="2"||k==="0")&&(e="/teacher/home"),a.path==="/login"&&T.value?c({path:e}):c()},setup(){const a=U();localStorage.getItem(t.userLang);const o=d(""),c=d(""),e=d({}),r=d(""),n=d("black"),i=d(!1),b=d(!1);return{usernameLabel:B(()=>`Username / NIG (${g("login_nig")})`),conf:t,companyLogoPushLeft:a.screen.lt.sm?"left: 27%":"left: 30%",styleSelector(u){const p={light:{bgImage:"bg-img-light",card:"",icon:"primary",label:"",input:"auth-input",inputColor:"input-color",btn:"blue",poweredLogo:"powered-style"},dark:{bgImage:"bg-img-dark",card:"auth-box-dark",icon:"blue-1",label:"blue-1",input:"auth-input-dark",inputColor:"input-color-dark",btn:"cyan-10",poweredLogo:""}};return a.cookies.get("theme")==="dark"?p.dark[u]:p.light[u]},validate(){r.value="",i.value=!0;const u=()=>i.value=!1;if(o.value===""||c.value==="")r.value=g("userpassword_wajib"),n.value="negative",setTimeout(u,6e3);else{const p={username:o.value,password:c.value,remember:b.value?1:0};r.value=g("mengautentikasi"),n.value=a.cookies.get("theme")==="dark"?"white":"black",D.post(`${t.coreAPI}login/validasi`,p,{transformRequest:[v=>P(v)]}).then(v=>{const s=v.data;if(s.msg==="expired")n.value="negative",r.value=s.note;else if(s.msg==="valid"){r.value=g("login_sukses"),n.value="positive",b.value&&(t.cookieExp*=12*30);const I=new Date,V=I.getTime(),q=V+t.cookieExp,M=new Date(q),w={expires:M.toUTCString(),path:"/",sameSite:"None",secure:!0};a.cookies.set(t.cookieName,s.token,w),a.cookies.set(t.userType,s.level,w),localStorage.setItem(t.userLang,s.lang),s.level==="1"?(window.location.href=t.homeUrl(),localStorage.removeItem("grade_id")):(s.level==="2"||s.level==="0")&&(localStorage.setItem("grade_id",s.grade),window.location.href=t.teacherHomeUrl())}else s.msg==="unauthorized"?(n.value="negative",r.value=g("salah_akses"),setTimeout(u,8e3)):(n.value="negative",r.value=g("invalid_login"),setTimeout(u,4e3))})}},username:o,password:c,error:e,msg:r,msgClass:n,showMsg:i,rememberMe:b,btnStyle:E({fontSize:"18px",width:"calc(100% - 5px)",borderRadius:a.screen.lt.sm?"28px":"5px"})}}},ee={class:"q-pa-md q-mt-md row items-start q-gutter-md"},ae={class:"text-center text-uppercase q-pt-lg q-pb-sm"},le={id:"company-logo",class:"col-12 col-md-4 col-sm-8 offset-md-4 offset-sm-2"};function oe(a,o,c,e,r,n){return x(),K(X,{view:"hHh lpR fFf"},{default:m(()=>[l(W,{class:f(["bg-login",e.styleSelector("bgImage")])},{default:m(()=>[h("div",ee,[l(z,{class:f(["auth-box col-md-4 col-sm-8 offset-md-4 offset-sm-2",e.styleSelector("card")])},{default:m(()=>[l(F,null,{default:m(()=>[l(_,{src:Y,width:"20%",ratio:1,class:"app-logo"}),h("p",ae,y(a.$t("silakan_login")),1),l(R,{class:"q-gutter-xs",onSubmit:H(e.validate,["prevent"])},{default:m(()=>[l(S,{filled:"",class:"q-mb-md",modelValue:e.username,"onUpdate:modelValue":o[0]||(o[0]=i=>e.username=i),label:e.usernameLabel,onKeyup:C(e.validate,["enter"]),"label-color":e.styleSelector("label"),color:e.styleSelector("icon")},{prepend:m(()=>[l(L,{name:"mail_outline"})]),_:1},8,["modelValue","label","onKeyup","label-color","color"]),l(S,{type:"password",filled:"",modelValue:e.password,"onUpdate:modelValue":o[1]||(o[1]=i=>e.password=i),label:"Password",onKeyup:C(e.validate,["enter"]),"label-color":e.styleSelector("label")},{prepend:m(()=>[l(L,{name:"vpn_key"})]),_:1},8,["modelValue","onKeyup","label-color"]),l(A,{color:"primary","keep-color":"",class:"q-mb-lg",modelValue:e.rememberMe,"onUpdate:modelValue":o[2]||(o[2]=i=>e.rememberMe=i),label:a.$t("remember_me")},null,8,["modelValue","label"]),e.showMsg?(x(),G("p",{key:0,style:{"margin-top":"-20px"},class:f(`text-bold text-${e.msgClass}`)},y(e.msg),3)):j("",!0),l(J,{color:e.styleSelector("btn"),onClick:e.validate,style:Q(e.btnStyle)},{default:m(()=>[O(y(a.$t("login")),1)]),_:1},8,["color","onClick","style"])]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["class"]),h("div",le,[l(_,{class:f(e.styleSelector("poweredLogo")),src:Z,width:"40%",style:Q(e.companyLogoPushLeft)},null,8,["class","style"])])])]),_:1},8,["class"])]),_:1})}var ie=N($,[["render",oe]]);export{ie as default};
